#!/usr/bin/env node
(()=>{var dn=Object.create;var Te=Object.defineProperty;var pn=Object.getOwnPropertyDescriptor;var mn=Object.getOwnPropertyNames;var un=Object.getPrototypeOf,fn=Object.prototype.hasOwnProperty;var s=(e=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(e,{get:(t,r)=>(typeof require<"u"?require:t)[r]}):e)(function(e){if(typeof require<"u")return require.apply(this,arguments);throw new Error('Dynamic require of "'+e+'" is not supported')});var tt=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),gn=(e,t)=>{for(var r in t)Te(e,r,{get:t[r],enumerable:!0})},hn=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of mn(t))!fn.call(e,o)&&o!==r&&Te(e,o,{get:()=>t[o],enumerable:!(n=pn(t,o))||n.enumerable});return e};var p=(e,t,r)=>(r=e!=null?dn(un(e)):{},hn(t||!e||!e.__esModule?Te(r,"default",{value:e,enumerable:!0}):r,e));var ve=tt((ds,Wt)=>{var qn=Object.create,he=Object.defineProperty,Vn=Object.getOwnPropertyDescriptor,Mn=Object.getOwnPropertyNames,Bn=Object.getPrototypeOf,Wn=Object.prototype.hasOwnProperty,Hn=(e,t)=>{for(var r in t)he(e,r,{get:t[r],enumerable:!0})},Lt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Mn(t))!Wn.call(e,o)&&o!==r&&he(e,o,{get:()=>t[o],enumerable:!(n=Vn(t,o))||n.enumerable});return e},zn=(e,t,r)=>(r=e!=null?qn(Bn(e)):{},Lt(t||!e||!e.__esModule?he(r,"default",{value:e,enumerable:!0}):r,e)),Jn=e=>Lt(he({},"__esModule",{value:!0}),e),Ut={};Hn(Ut,{DevToolsContext:()=>Bt,DevToolsContextProvider:()=>Gn,DevtoolsEvent:()=>Ft,hooksByScope:()=>Yn,receive:()=>Mt,scopes:()=>qt,send:()=>Vt});Wt.exports=Jn(Ut);var Ft=(e=>(e.RELOAD="devtools:reload",e.DEVTOOLS_INIT="devtools:init",e.DEVTOOLS_HANDSHAKE="devtools:handshake",e.DEVTOOLS_ALREADY_CONNECTED="devtools:already-connected",e.ACTIVITY="devtools:send-activity",e.DEVTOOLS_ACTIVITY_UPDATE="devtools:activity-update",e.DEVTOOLS_CONNECTED_APP="devtools:connected-app",e.DEVTOOLS_DISCONNECTED_APP="devtools:disconnected-app",e.DEVTOOLS_HIGHLIGHT_IN_MONITOR="devtools:highlight-in-monitor",e.DEVTOOLS_HIGHLIGHT_IN_MONITOR_ACTION="devtools:highlight-in-monitor-action",e.DEVTOOLS_LOGIN_SUCCESS="devtools:login-success",e.DEVTOOLS_RELOAD_AFTER_LOGIN="devtools:reload-after-login",e))(Ft||{}),qt={useCan:"access-control",useLog:"audit-log",useLogList:"audit-log",useCreate:"data",useCreateMany:"data",useCustom:"data",useCustomMutation:"data",useDelete:"data",useDeleteMany:"data",useInfiniteList:"data",useList:"data",useMany:"data",useOne:"data",useUpdate:"data",useUpdateMany:"data",useForgotPassword:"auth",useGetIdentity:"auth",useIsAuthenticated:"auth",useLogin:"auth",useLogout:"auth",useOnError:"auth",usePermissions:"auth",useRegister:"auth",useUpdatePassword:"auth"},Yn=Object.entries(qt).reduce((e,[t,r])=>(e[r]||(e[r]=[]),e[r].push(t),e),{}),X=zn(s("react"));async function Vt(e,t,r){if(e.readyState!==e.OPEN){await new Promise(n=>{let o=()=>{e.send(JSON.stringify({event:t,payload:r})),n(),e.removeEventListener("open",o)};e.addEventListener("open",o)});return}else{e.send(JSON.stringify({event:t,payload:r}));return}}function Mt(e,t,r){let n=o=>{let{event:a,payload:c}=JSON.parse(o.data);t===a&&r(c)};return e.addEventListener("message",n),()=>{e.removeEventListener("message",n)}}var Bt=X.default.createContext({__devtools:!1,port:5002,url:"localhost",secure:!1,ws:null}),Gn=({__devtools:e,port:t,children:r})=>{let[n,o]=X.default.useState({__devtools:e??!1,port:t??5002,url:"localhost",secure:!1,ws:null}),[a,c]=X.default.useState(null);X.default.useEffect(()=>{let d=new WebSocket(`${n.secure?"wss":"ws"}://localhost:${n.port}`),l=Mt(d,"devtools:handshake",u=>{o(w=>({...w,devtoolsUrl:u.url})),l()});return d.addEventListener("open",()=>{n.__devtools||Vt(d,"devtools:init",{url:window.location.origin})}),c(d),()=>{l(),d.close(1e3,window.location.origin)}},[]);let i=X.default.useMemo(()=>({...n,ws:a}),[n,a]);return X.default.createElement(Bt.Provider,{value:i},r)}});var rr=tt((fs,tr)=>{var Xn=Object.create,we=Object.defineProperty,Kn=Object.getOwnPropertyDescriptor,Qn=Object.getOwnPropertyNames,Zn=Object.getPrototypeOf,eo=Object.prototype.hasOwnProperty,to=(e,t)=>{for(var r in t)we(e,r,{get:t[r],enumerable:!0})},Gt=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Qn(t))!eo.call(e,o)&&o!==r&&we(e,o,{get:()=>t[o],enumerable:!(n=Kn(t,o))||n.enumerable});return e},y=(e,t,r)=>(r=e!=null?Xn(Zn(e)):{},Gt(t||!e||!e.__esModule?we(r,"default",{value:e,enumerable:!0}):r,e)),ro=e=>Gt(we({},"__esModule",{value:!0}),e),Xt={};to(Xt,{server:()=>aa});tr.exports=ro(Xt);var no=y(s("express")),Ne=s("chalk"),P=ve(),oo=y(s("express")),Ht=y(s("path")),ao=e=>{e.use(oo.default.static(Ht.default.join(__dirname,"client"))),e.use((t,r,n)=>{if(t.path.startsWith("/api")||t.path.startsWith("/open-in-editor"))return n();r.status(200).sendFile(Ht.default.join(__dirname+"/client/index.html"))})},io=y(s("ws")),$e="https://cloud2.refine.dev",so="https://raw.githubusercontent.com/refinedev/refine/master/packages/devtools-server/FEED.md",zt=ve(),co=()=>{let e=new io.default.Server({port:5002});return e.on("connection",t=>{(0,zt.send)(t,zt.DevtoolsEvent.DEVTOOLS_HANDSHAKE,{url:"http://localhost:5001"}),t.on("close",()=>{t.terminate()})}),process.on("SIGTERM",()=>{e.close(()=>{})}),e},ps=s("lodash"),ms=ve(),us=s("ws"),lo=()=>0,po=e=>{let t=e.listen(5001,()=>{});process.on("SIGTERM",()=>{t.close(()=>{})})},mo={connectedApp:null,clientWs:null,devtoolsWsClients:[],appWsClients:[],activities:[],packages:[]},uo=()=>({...mo}),fo=s("express"),go=y(s("lodash/uniq")),ho=y(s("node-fetch")),vo=y(s("gray-matter")),je=s("marked"),De=y(s("sanitize-html")),yo=e=>e.split("---section").slice(1).map(t=>`---section${t}`),wo=e=>{let t=new je.marked.Renderer;t.link=function(...n){return je.marked.Renderer.prototype.link.apply(this,n).replace(/^<a/,'<a target="_blank" rel="noopener noreferrer"')};let r=(0,je.marked)(e,{renderer:t});return(0,De.default)(r,{allowedTags:De.default.defaults.allowedTags.concat(["img"]),allowedAttributes:{...De.default.defaults.allowedAttributes,img:["src"]}})},Po=e=>{let t=(0,vo.default)(e.replace("---section","---"));return{...t.data,content:wo(t.content)}},Eo=async()=>{try{return(await(0,ho.default)(so)).text()}catch{return""}},Ro=async()=>{try{let e=await Eo();return yo(e).map(Po)}catch{return[]}},xo=y(s("fs")),Io=y(s("path")),bo=y(s("globby")),Co=async e=>{try{let t=await(0,bo.default)(`node_modules/${e}/package.json`,{onlyFiles:!0}),r=null;try{let n=s.resolve(Io.default.join(e,"package.json"));n&&(r=n)}catch{}return[...t,...r?[r]:[]][0]??null}catch{return null}},Oo=async e=>{try{let t=await Co(e);if(!t)return null;let r=JSON.parse(xo.default.readFileSync(t,{encoding:"utf-8"}));return{name:r.name,version:r.version,description:r.description}}catch{return null}},To=y(s("path")),Ao=s("fs-extra"),Kt=async(e=process.cwd())=>{let t=await(0,Ao.readJSON)(To.default.join(e,"package.json"),{encoding:"utf-8"});return Object.keys(t.dependencies).filter(r=>r.startsWith("@refinedev/"))},_o=e=>e.replace("@refinedev/","https://c.refine.dev/"),ko=e=>"https://refine.dev/docs/api-reference/general-concepts/",So=async e=>{try{let t=await Kt(e);return await Promise.all(t.map(async r=>{let n=await Oo(r);return{name:r,currentVersion:n==null?void 0:n.version,description:n==null?void 0:n.description,changelog:_o(r),documentation:ko(r)}}))}catch{return[]}},v=y(s("dedent")),No=[{name:"@refinedev/ably",description:"Ably integration for refine",install:"npm install @refinedev/ably",usage:(0,v.default)(`
            import { liveProvider, Ably } from "@refinedev/ably";

            export const ablyClient = new Ably.Realtime("YOUR_API_TOKEN");

            const App = () => {
                return (
                    <Refine
                        liveProvider={liveProvider(ablyClient)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
        `.trim())},{name:"@refinedev/airtable",description:"Airtable integration for refine",install:"npm install @refinedev/airtable",usage:(0,v.default)(`
            import dataProvider from "@refinedev/airtable";

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider("API_KEY", "BASE_ID")}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/antd",description:"Ant Design integration for refine",install:"npm install @refinedev/antd antd",usage:(0,v.default)(`
            import { ThemedLayoutV2 } from "@refinedev/antd";

            import "@refinedev/antd/dist/reset.css";

            const App = () => {
                return (
                    <Refine
                        /* ... */
                    >
                        <ThemedLayoutV2>
                            {/* ... */}
                        </ThemedLayoutV2>
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/appwrite",description:"Appwrite integration for refine",install:"npm install @refinedev/appwrite",usage:(0,v.default)(`
            import { dataProvider, liveProvider, Account, Appwrite, Storage } from "@refinedev/appwrite";

            const appwriteClient = new Appwrite();
            appwriteClient.setEndpoint("API_URL").setProject("PROJECT_ID");

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider(appwriteClient, { databaseId: "default" })}
                        liveProvider={liveProvider(appwriteClient, { databaseId: "default" })}
                        /* ... */
                    >
                        <ThemedLayout>
                            {/* ... */}
                        </ThemedLayout>
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/chakra-ui",description:"Chakra UI integration for refine",install:"npm install @refinedev/chakra-ui @chakra-ui/react @emotion/react @emotion/styled framer-motion",usage:(0,v.default)(`
            import { ThemedLayoutV2 } from "@refinedev/chakra-ui";
            import { ChakraProvider } from "@chakra-ui/react";

            const App = () => {
                return (
                        <ChakraProvider>
                        <Refine
                            /* ... */
                        >
                            <ThemedLayoutV2>
                                {/* ... */}
                            </ThemedLayoutV2>
                        </Refine>
                    </ChakraProvider>
                );
            };
            `.trim())},{name:"@refinedev/graphql",description:"GraphQL integration for refine",install:"npm install @refinedev/graphql",usage:(0,v.default)(`
            import dataProvider, { GraphQLClient } from "@refinedev/graphql";

            const client = new GraphQLClient("YOUR_API_URL");

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider(client)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/hasura",description:"GraphQL integration for refine",install:"npm install @refinedev/hasura",usage:(0,v.default)(`
            import dataProvider, { GraphQLClient } from "@refinedev/hasura";

            const client = new GraphQLClient("HASURA_API_URL", {
                headers: {
                    "x-hasura-role": "public",
                },
            });

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider(client)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/inferencer",description:"Auto generate views based on your APIs with refine",install:"npm install @refinedev/inferencer",usage:(0,v.default)(`
        import { AntdInferencer } from "@refinedev/inferencer/antd";

        const App = () => {
            return (
                <Refine
                    /* ... */
                >
                    <AntdInferencer action="list" resource="posts" />
                </Refine>
            );
        };
        `.trim())},{name:"@refinedev/kbar",description:"Command palette integration with kbar for refine",install:"npm install @refinedev/kbar",usage:(0,v.default)(`
            import { RefineKbar, RefineKbarProvider } from "@refinedev/kbar";

            const App = () => {
                return (
                    <RefineKbarProvider>
                        <Refine
                            /* ... */
                        >
                            <RefineKbar />
                        </Refine>
                    </RefineKbarProvider>
                );
            };
        `.trim())},{name:"@refinedev/mantine",description:"Mantine UI integration for refine",install:"npm install @refinedev/mantine @refinedev/react-table @mantine/core @mantine/hooks @mantine/form @mantine/notifications @emotion/react @tabler/icons",usage:(0,v.default)(`
            import { ThemedLayoutV2 } from "@refinedev/mantine";
            import { MantineProvider } from "@mantine/core";

            const App = () => {
                return (
                    <MantineProvider>
                        <Refine
                            /* ... */
                        >
                            <ThemedLayoutV2>
                                {/* ... */}
                            </ThemedLayoutV2>
                        </Refine>
                    </MantineProvider>
                );
            };
            `.trim())},{name:"@refinedev/medusa",description:"Medusa store integration for refine",install:"npm install @refinedev/medusa",usage:(0,v.default)(`
            import dataProvider, { authProvider } from "@refinedev/medusa";

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider("API_URL")}
                        authProvider={authProvider("API_URL")}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/mui",description:"Material UI integration for refine",install:"npm install @refinedev/mui @refinedev/react-hook-form @mui/material @mui/lab @mui/x-data-grid @emotion/react @emotion/styled react-hook-form",usage:(0,v.default)(`
            import { ThemedLayoutV2 } from "@refinedev/mui";

            import CssBaseline from "@mui/material/CssBaseline";
            import GlobalStyles from "@mui/material/GlobalStyles";
            import { ThemeProvider } from "@mui/material/styles";

            const App = () => {
                return (
                    <ThemeProvider>
                        <CssBaseline />
                        <GlobalStyles styles={{ html: { WebkitFontSmoothing: "auto" } }} />
                        <Refine
                            /* ... */
                        >
                            <ThemedLayoutV2>
                                {/* ... */}
                            </ThemedLayoutV2>
                        </Refine>
                    </ThemeProvider>
                );
            };
            `.trim())},{name:"@refinedev/nestjs-query",description:"NestJS Query data provider integration for refine",install:"npm install @refinedev/nestjs-query graphql-ws",usage:(0,v.default)(`
            import dataProvider, {
                GraphQLClient,
                liveProvider,
            } from "@refinedev/nestjs-query";

            import { createClient } from "graphql-ws";

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider(new GraphQLClient( "API_URL" ))}
                        liveProvider={liveProvider(createClient({ url: "WS_URL" }))}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/nestjsx-crud",description:"NestJSX CRUD data provider integration for refine",install:"npm install @refinedev/nestjsx-crud",usage:(0,v.default)(`
            import dataProvider from "@refinedev/nestjsx-crud";

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider("API_URL")}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/nhost",description:"NHost data provider and live provider integrations for refine",install:"npm install @refinedev/nhost @nhost/nhost-js @nhost/react-auth",usage:(0,v.default)(`
            import { NhostClient } from "@nhost/nhost-js";
            import dataProvider, { graphqlWS } from "@refinedev/nhost";

            const nhost = new NhostClient({ backendUrl: "NHOST_API_URL" });

            const gqlWsClient = graphqlWS.createClient({
                url: WS_URL,
                connectionParams: () => ({
                    headers: {
                        Authorization: \`Bearer \${nhost.auth.getJWTToken()}\`,
                    },
                })
            });

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider(nhost)}
                        liveProvider={liveProvider(gqlWsClient)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/react-hook-form",description:"React Hook Form integration for refine",install:"npm install @refinedev/react-hook-form react-hook-form",usage:(0,v.default)(`
            import { useForm } from "@refinedev/react-hook-form";

            const EditPost = () => {
                const {
                    register,
                    handleSubmit,
                    formState,
                    refineCore,
                } = useForm({
                    refineCoreProps: {
                        resource: "posts",
                        id: "1",
                    },
                });

                return /* ... */
            };
            `.trim())},{name:"@refinedev/react-table",description:"Tanstack React Table integration for refine",install:"npm install @refinedev/react-table @tanstack/react-table",usage:(0,v.default)(`
            import { useTable } from "@refinedev/react-table";

            import { ColumnDef, flexRender } from "@tanstack/react-table";

            const EditPost = () => {
                const columns = React.useMemo<ColumnDef<IPost>[]>(
                    () => [
                        {
                            id: "id",
                            header: "ID",
                            accessorKey: "id",
                        },
                        {
                            id: "title",
                            header: "Title",
                            accessorKey: "title",
                            meta: {
                                filterOperator: "contains",
                            },
                        },
                ], []);

                const tableInstance = useTable({
                    columns,
                    refineCoreProps: {
                        resource: "posts",
                    }
                });

                return /* ... */
            };
            `.trim())},{name:"@refinedev/simple-rest",description:"Data provider integration for REST APIs with refine",install:"npm install @refinedev/simple-rest",usage:(0,v.default)(`
            import dataProvider from "@refinedev/simple-rest";

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider("API_URL")}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/supabase",description:"Data provider and live provider integrations for Supabase with refine",install:"npm install @refinedev/supabase",usage:(0,v.default)(`
            import { dataProvider, liveProvider, createClient } from "@refinedev/supabase";

            const supabaseClient = createClient("SUPABASE_URL", "SUPABASE_KEY");

            const App = () => {
                return (
                    <Refine
                        dataProvider={dataProvider(supabaseClient)}
                        liveProvider={liveProvider(supabaseClient)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/strapi",description:"Strapi integration of refine",install:"npm install @refinedev/strapi axios",usage:(0,v.default)(`
            import { DataProvider, AuthHelper } from "@refinedev/strapi";

            const axiosInstance = axios.create();
            const strapiAuthHelper = AuthHelper("API_URL");

            const App = () => {
                return (
                    <Refine
                        dataProvider={DataProvider("API_URL", axiosInstance)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/strapi-v4",description:"StrapiV4 integration of refine",install:"npm install @refinedev/strapi-v4 axios",usage:(0,v.default)(`
            import { DataProvider, AuthHelper } from "@refinedev/strapi-v4";

            const axiosInstance = axios.create();
            const strapiAuthHelper = AuthHelper("API_URL");

            const App = () => {
                return (
                    <Refine
                        dataProvider={DataProvider("API_URL", axiosInstance)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())},{name:"@refinedev/strapi-graphql",description:"Strapi GraphQL integration of refine",install:"npm install @refinedev/strapi-graphql",usage:(0,v.default)(`
            import dataProvider, { GraphQLClient } from "@refinedev/strapi-graphql";

            const client = new GraphQLClient("API_URL");

            const App = () => {
                return (
                    <Refine
                    dataProvider={dataProvider(client)}
                        /* ... */
                    >
                        {/* ... */}
                    </Refine>
                );
            };
            `.trim())}],jo=async e=>{let t=await Kt(e);return No.filter(r=>!t.includes(r.name))},Do=y(s("preferred-pm")),$o=y(s("execa")),Lo=async(e,t=process.cwd())=>{try{let{name:r}=await(0,Do.default)(t)??{name:"npm"},{failed:n}=await(0,$o.default)(r??"npm",["install",...e.map(o=>`${o}@latest`)]);return!n}catch{return!1}},Uo=y(s("execa")),Fo=async e=>{try{let{stdout:t}=await(0,Uo.default)("npm",["view",e,"name","version","--json"]);return JSON.parse(t)}catch{return{name:e}}},qo=s("fs-extra"),Vo=y(s("path")),Qt=async(e=process.cwd())=>{var t;try{let r=await(0,qo.readJSON)(Vo.default.join(e,"package.json"),{encoding:"utf-8"});return((t=r==null?void 0:r.refine)==null?void 0:t.projectId)||!1}catch{return null}},Mo=y(s("execa")),Bo=async(e,t=process.cwd())=>{try{return Mo.default.sync("npm",["pkg","set",`refine.projectId=${e}`],{cwd:t}),!0}catch{return null}},Wo=y(s("execa")),Jt=y(s("path")),Ho=async(e,t=process.cwd())=>{try{let r=s.resolve(".bin/jscodeshift"),n=Wo.default.sync(r,["./","--extensions=ts,tsx,js,jsx","--parser=tsx",`--transform=${Jt.default.resolve(Jt.default.join(__dirname,"..","src","project-id","transform.ts"))}`,"--ignore-pattern=**/.cache/**","--ignore-pattern=**/node_modules/**","--ignore-pattern=**/build/**","--ignore-pattern=**/dist/**","--ignore-pattern=**/.next/**",`--__projectId=${e}`],{cwd:t,timeout:1e3*10});n.stderr&&console.error(n.stderr)}catch(r){console.error(r)}},zo=async(e,t=process.cwd())=>{try{return await Promise.all([Bo(e,t),Ho(e,t)]),!0}catch{return!1}},Jo=(e,t)=>{e.use("/api",(0,fo.json)()),e.get("/api/connected-app",(c,i)=>{i.json({url:t.connectedApp})}),e.get("/api/activities",(c,i)=>{let{offset:d=0,limit:l=t.activities.length}=c.query;i.setHeader("x-total-count",t.activities.length),i.json({data:t.activities.slice(Number(d),Number(l))})}),e.get("/api/activities/reset",(c,i)=>{t.activities=[],i.json({success:!0})}),e.get("/api/unique-trace-items",(c,i)=>{i.header("Access-Control-Allow-Origin","*"),i.header("Access-Control-Allow-Headers","Origin, X-Requested-With, Content-Type, Accept");let d=t.activities.flatMap(u=>{var w;return((w=u.trace)==null?void 0:w.map(R=>R.function).filter(Boolean))??[]}),l=(0,go.default)(d);i.setHeader("x-total-count",l.length),i.json({data:l})});let r=null;e.get("/api/installed-packages",async(c,i)=>{let{force:d}=c.query??{};(!r||d)&&(r=await So()),i.header("x-total-count",`${r.length}`),i.json({data:r})});let n=null;e.get("/api/available-packages",async(c,i)=>{n||(n=await jo()),i.header("x-total-count",`${n.length}`),i.json({data:n})});let o=new Map;e.get("/api/packages/:packageName/latest",async(c,i)=>{let{packageName:d}=c.params??{};if(!d){i.status(400).json({error:"Package name is required"});return}if(!o.has(d)){let l=await Fo(d);o.set(d,l)}return i.json({data:o.get(d)})}),e.post("/api/packages/install",async(c,i)=>{let{packages:d}=c.body??{};if((d==null?void 0:d.length)===0){i.status(400).json({error:"Package name is required"});return}await Lo(d)?(r=null,n=null,i.status(200).json({success:!0})):i.status(400).json({success:!1,error:"Failed to update package"})});let a=null;e.get("/api/feed",async(c,i)=>{a||(a=await Ro()),i.header("x-total-count",`${a.length}`),i.json({data:a})}),e.get("/api/project-id/status",async(c,i)=>{let d=await Qt();if(d){i.status(200).json({projectId:d});return}else if(d===!1){i.status(404).json({projectId:null});return}else{i.status(500).json({projectId:null});return}}),e.post("/api/project-id/update",async(c,i)=>{let{projectId:d}=c.body??{};if(!d){i.status(400).json({error:"Project ID is required"});return}if(await zo(d)){i.status(200).json({success:!0});return}else{i.status(500).json({success:!1,error:"Failed to update project ID"});return}})},Zt=s("fs-extra"),Yo=s("@ory/client"),Yt=s("http-proxy-middleware"),er=y(s("path")),ye=null,Go=async(e,t,r)=>{ye||(ye=await Qt()),ye&&(e.headers["x-project-id"]=ye),r()},Xo=function(e,t){if(t.body){let r=JSON.stringify(t.body);e.setHeader("Content-Type","application/json"),e.setHeader("Content-Length",Buffer.byteLength(r)),e.write(r)}},Ko=async e=>{try{let t=`${$e}/.auth`,r=new Yo.FrontendApi({isJsonMime:()=>!0,basePath:t,baseOptions:{withCredentials:!0}}),{data:n}=await r.toSession({xSessionToken:e,tokenizeAs:"jwt_template_1"});return n==null?void 0:n.tokenized}catch{}},Qo=async(e,t)=>{try{(0,Zt.writeJSON)(er.default.join(__dirname,"..",".persist.json"),{token:e,jwt:t})}catch{}},Zo=async()=>{try{return await(0,Zt.readJSON)(er.default.join(__dirname,"..",".persist.json"))}catch{}return{token:void 0,jwt:void 0}},ea=e=>function(t,r){if(r.url.includes("self-service/logout/api")){let n=JSON.stringify({session_token:e});t.setHeader("Content-Length",Buffer.byteLength(n)),t.write(n)}},ta=e=>function(t,r,n){let o="";t.on("data",a=>{o+=a}),t.on("end",()=>{var a;let c;try{c=JSON.parse(o).session_token}catch{}if(!c){if((a=o==null?void 0:o.includes)!=null&&a.call(o,"an+account+with+the+same+identifier")){n.redirect("/after-login?error=An+account+with+the+same+identifier+exists+already");return}n.redirect("/after-login?error=Invalid-session-token");return}Ko(c).then(i=>{e(c,i??""),n.redirect("/after-login")})})},ra=async e=>{let{token:t,jwt:r}=await Zo(),n=(0,Yt.createProxyMiddleware)({target:$e,changeOrigin:!0,pathRewrite:{"^/api/.auth":"/.auth"},cookieDomainRewrite:{"refine.dev":""},logLevel:"silent",headers:{"auth-base-url-rewrite":"http://localhost:5001/api/.auth"},selfHandleResponse:!0,onProxyReq:(a,c,...i)=>{t&&(a.setHeader("X-Session-Token",t??""),ea(t)(a,c,...i))},onProxyRes:(a,c,i)=>{if(c.url.includes("self-service/methods/oidc/callback"))return ta((d,l)=>{t=d,r=l,Qo(t,r)})(a,c,i);i.writeHead(a.statusCode||500,a.headers),a.pipe(i,{end:!0})}});e.use("/api/.auth",n);let o=(0,Yt.createProxyMiddleware)({target:$e,secure:!1,changeOrigin:!0,logLevel:"silent",pathRewrite:{"^/api/.refine":"/.refine"},onProxyReq:(a,...c)=>{r&&(a.setHeader("Authorization",`Bearer ${r}`),a.removeHeader("cookie")),Xo(a,...c)}});e.use("/api/.refine",Go,o)},na=y(s("path")),oa=(e,t)=>{e.get("/open-in-editor/*",(r,n)=>{let{line:o,column:a}=r.query,c=r.path.replace("/open-in-editor",""),i=`vscode://file/${na.default.join(t,c)}?${o?`line=${o}`:""}${a?`&column=${a}`:""}`;n.redirect(i)})},aa=async({projectPath:e=process.cwd()}={})=>{let t=(0,no.default)(),r=co(),n=uo();r.on("connection",o=>{(0,P.receive)(o,P.DevtoolsEvent.DEVTOOLS_INIT,a=>{n.connectedApp?(0,P.send)(o,P.DevtoolsEvent.DEVTOOLS_ALREADY_CONNECTED,{url:n.connectedApp}):(n.connectedApp=a.url,n.clientWs=o,r.clients.forEach(c=>{(0,P.send)(c,P.DevtoolsEvent.DEVTOOLS_CONNECTED_APP,{url:n.connectedApp})}))}),(0,P.receive)(o,P.DevtoolsEvent.ACTIVITY,a=>{let c=n.activities.findIndex(d=>d.identifier===a.identifier),i={...a,createdAt:Date.now(),updatedAt:Date.now()};c>-1?(i.createdAt=n.activities[c].createdAt,n.activities[c]=i):n.activities.push(i),r.clients.forEach(d=>{(0,P.send)(d,P.DevtoolsEvent.DEVTOOLS_ACTIVITY_UPDATE,{updatedActivities:[i]})})}),(0,P.receive)(o,P.DevtoolsEvent.DEVTOOLS_HIGHLIGHT_IN_MONITOR,({name:a})=>{r.clients.forEach(c=>{(0,P.send)(c,P.DevtoolsEvent.DEVTOOLS_HIGHLIGHT_IN_MONITOR_ACTION,{name:a})})}),(0,P.receive)(o,P.DevtoolsEvent.DEVTOOLS_LOGIN_SUCCESS,()=>{r.clients.forEach(a=>{(0,P.send)(a,P.DevtoolsEvent.DEVTOOLS_RELOAD_AFTER_LOGIN,{})})}),o.on("close",(a,c)=>{n.clientWs&&(r.clients.has(n.clientWs)||(n.clientWs=null,n.connectedApp=null,n.activities=[],r.clients.forEach(i=>{(0,P.send)(i,P.DevtoolsEvent.DEVTOOLS_DISCONNECTED_APP,{url:n.connectedApp})})))})}),lo(r),ao(t),po(t),Jo(t,n),ra(t),oa(t,e),console.log(`
${Ne.cyanBright.bold("\u2713 ")}${(0,Ne.bold)("refine devtools")} is running at port ${Ne.cyanBright.bold(5001)}
`)}});var an=s("commander"),sn=p(s("figlet"));var ft=p(s("cli-table3")),M=p(s("chalk")),de=p(s("center-align"));var rt=p(s("ora")),vn=async(e,t)=>{let r=(0,rt.default)({color:"cyan",text:t}).start(),n=await e();return r.stop(),n},F=vn;var ie=p(s("execa")),D=s("fs-extra"),nt=p(s("globby")),Ae=p(s("path")),ot=p(s("preferred-pm"));var q=()=>{if(!(0,D.existsSync)("package.json"))throw new Error("./package.json not found");return JSON.parse((0,D.readFileSync)("package.json","utf8"))},ee=()=>{let e=q();return Object.keys(e.dependencies||{})};var at=()=>{let e=q();return Object.keys(e.devDependencies||{})},se=()=>q().scripts,z=async()=>{var e;try{let t=await(0,ie.default)("npm",["ls","--depth=0","--json"],{reject:!1}),r=((e=JSON.parse(t.stdout))==null?void 0:e.dependencies)||{},n=Object.keys(r).filter(a=>a.startsWith("@refinedev")||a.startsWith("@pankod/refine-")),o=[];for(let a of n){let c=r[a].version;o.push({name:a,version:c})}return o}catch{return Promise.resolve(null)}},te=async()=>{let e=["ably","airtable","antd","appwrite","chakra-ui","codemod","connect","core","devtools","devtools-internal","devtools-server","devtools-shared","devtools-ui","graphql","hasura","inferencer","kbar","mantine","medusa","mui","nestjs-query","nestjsx-crud","nextjs-router","nhost","react-hook-form","react-location","react-router-v6","react-table","remix","sdk","shared","simple-rest","strapi","strapi-graphql","strapi-v4","supabase"];try{let t=await(0,nt.default)("node_modules/@refinedev/*",{onlyDirectories:!0}),r=e.flatMap(o=>{try{let a=s.resolve(Ae.default.join("@refinedev",o,"package.json"));return[Ae.default.dirname(a)]}catch{return[]}}),n=[];return await Promise.all([...r,...t].map(async o=>{if(await(0,D.pathExists)(`${o}/package.json`)){let c=await(0,D.readJSON)(`${o}/package.json`);n.push({name:c.name,version:c.version,path:o})}})),n}catch{return[]}},it=async e=>await(0,D.pathExists)(`${e}/refine.config.js`),V={npm:{install:["install","--save"],installDev:["install","--save-dev"],outdatedJson:["outdated","--json"]},yarn:{install:["add"],installDev:["add","-D"],outdatedJson:["outdated","--json"]},pnpm:{install:["add"],installDev:["add","-D"],outdatedJson:["outdated","--format","json"]}},b=async()=>{let e=await F(()=>(0,ot.default)(process.cwd()),"Getting package manager...");if(!e)throw new Error("Package manager not found.");return e},ce=async e=>{let t=await b();try{let r=V[t.name].install,n=(0,ie.default)(t.name,[...r,...e],{stdio:"inherit"});n.on("message",o=>{console.log(o)}),n.on("error",o=>{console.log(o)}),n.on("exit",o=>{if(o===0){console.log("All `refine` packages updated  \u{1F389}");return}console.log(`Application exited with code ${o}`)})}catch(r){throw new Error(r)}},st=async e=>{let t=await b();try{let r=V[t.name].install,n=ie.default.sync(t.name,[...r,...e],{stdio:"inherit"});if(n.failed||n.exitCode!==0)throw new Error(n.stderr);return n}catch(r){throw new Error(r)}},ct=e=>{let t=e.lastIndexOf("@");return t<=0?{name:e,version:null}:{name:e.slice(0,t),version:e.slice(t+1)}},lt=()=>{var t;let e=q();return(t=e==null?void 0:e.refine)==null?void 0:t.projectId},le=async()=>(await te()).some(t=>t.name==="@refinedev/devtools");var dt=e=>e.charAt(0).toUpperCase()+e.slice(1),pt=e=>e.replace(/[\u001b\u009b][[()#;?]*(?:[0-9]{1,4}(?:;[0-9]{0,4})*)?[0-9A-ORZcf-nqry=><]/g,"");var re={name:"name",current:"current",wanted:"wanted",latest:"latest",changelog:"changelog"},mt=[re.name,re.current,re.wanted,re.latest,re.changelog],pe=async e=>{var c;let t=e==null?void 0:e.data,r=Object.keys((t==null?void 0:t[0])||{});if(!t||!r.length)return;let n=new ft.default({head:mt,style:{head:["blue"]}});t.forEach(i=>{n.push(mt.map(d=>{let l=i[d];if(!l)return l;if(d==="latest"||d==="wanted"){let u=ut(i.current),w=ut(l),R=yn(u,w),g=M.default[R.major](w.major),m=M.default[R.minor](w.minor),f=M.default[R.patch](w.patch);return`${g}.${m}.${f}`}return d==="changelog"?M.default.blueBright.underline(l):l}))});let o=n.toString(),a=pt(((c=o.split(`
`))==null?void 0:c[0])||"").length;console.log(),console.log((0,de.default)("Update Available",a)),console.log(o),console.log((0,de.default)(`To update ${M.default.bold("`refine`")} packages with wanted version`,a)),console.log((0,de.default)(` Run the following command: ${M.default.yellowBright(await wn())}`,a)),console.log()},ut=e=>{let t=e.split(".");return{major:t[0],minor:t[1],patch:t[2]}},yn=(e,t)=>e.major.trim()!==t.major.trim()?{major:"red",minor:"red",patch:"red"}:e.minor.trim()!==t.minor.trim()?{major:"white",minor:"yellow",patch:"yellow"}:e.patch.trim()!==t.patch.trim()?{major:"white",minor:"white",patch:"green"}:{major:"white",minor:"white",patch:"white"},wn=async()=>{let e="npx @refinedev/cli update",t=ee(),r=Object.keys(se()),n=t.includes("@refinedev/cli"),o=r.includes("refine");if(!n&&!o)return e;let a=await b();return o?`${a.name} run refine update`:n?"npx refine update":e};var gt=p(s("execa"));var ht=p(s("semver-diff")),Pn=e=>e.command("check-updates").description("Check all installed `refine` packages are up to date").action(En),En=async()=>{let e=await F(ne,"Checking for updates...");if(!e.length){console.log("All `refine` packages are up to date \u{1F389}\n");return}await pe({data:e})},ne=async()=>await Rn(),Rn=async()=>{let e=await xn();if(!e)return[];let t=[],r;return Object.keys(e).forEach(o=>{let a=e[o];o.includes("@refinedev")&&(r=o.replace(/@refinedev\//,"https://c.refine.dev/"),t.push({name:o,current:a.current,wanted:a.wanted,latest:a.latest,changelog:r}))}),t.filter(o=>!!(0,ht.default)(o.current,o.latest))},xn=async()=>{let e="npm",{stdout:t,timedOut:r}=await(0,gt.default)(e,V[e].outdatedJson,{reject:!1,timeout:25e3});if(r)throw new Error("Timed out while checking for updates.");return t?JSON.parse(t):null},vt=Pn;var x=(i=>(i.REACT_SCRIPT="react-scripts",i.REMIX="remix",i.NEXTJS="nextjs",i.VITE="vite",i.CRACO="craco",i.PARCEL="parcel",i.UNKNOWN="unknown",i))(x||{});var _e=(o=>(o.ANTD="antd",o.MUI="mui",o.MANTINE="mantine",o.CHAKRA="chakra-ui",o))(_e||{});var yt=(n=>(n.NPM="npm",n.YARN="yarn",n.PNPM="pnpm",n))(yt||{});var E=e=>{if(e)return e;let t=ee(),r=at();return t.includes("@craco/craco")||r.includes("@craco/craco")?"craco":t.includes("react-scripts")||r.includes("react-scripts")?"react-scripts":t.includes("next")||r.includes("next")?"nextjs":t.includes("@remix-run/react")||r.includes("@remix-run/react")?"remix":t.includes("vite")||r.includes("vite")?"vite":t.includes("parcel")||r.includes("parcel")?"parcel":"unknown"},wt=()=>{let e=ee();if(e.includes("@refinedev/antd"))return"antd";if(e.includes("@refinedev/mui"))return"mui";if(e.includes("@refinedev/chakra-ui"))return"chakra-ui";if(e.includes("@refinedev/mantine"))return"mantine"};var oe=e=>{switch(e){case"nextjs":return{path:"src/components",alias:"../src/components"};case"remix":return{path:"app/components",alias:"~/components"}}return{path:"src/pages",alias:"pages"}},Pt=e=>{switch(e){case"nextjs":return{path:"src/providers",alias:"../src/providers"};case"remix":return{path:"app/providers",alias:"~/providers"}}return{path:"src/providers",alias:"providers"}},Et=e=>{switch(e){case"remix":return"./app";case"nextjs":case"react-scripts":case"vite":case"craco":case"parcel":case"unknown":default:return"./src"}};var T=s("fs-extra"),ue=p(s("temp")),xt=s("pluralize"),It=p(s("execa")),bt=p(s("inquirer")),ke=s("path");var B=p(s("handlebars")),N=s("fs-extra"),In=(e,t)=>{let r=(0,N.readFileSync)(e);return B.default.registerHelper("ifIn",function(o,a,c){return o.includes(a)?c.fn(B.default):c.inverse(B.default)}),B.default.registerHelper("formatInferencerComponent",function(o){if(o)switch(o){case"chakra-ui":return"ChakraUI";default:return o.charAt(0).toUpperCase()+o.slice(1)}}),B.default.registerHelper("capitalize",function(o){if(o)return o.charAt(0).toUpperCase()+o.slice(1)}),B.default.compile(r.toString())(t)},Rt=(e,t)=>{(0,N.readdirSync)(e).forEach(n=>{let o=`${e}/${n}`,a=`${e}/${n.replace(".hbs","")}`;(0,N.createFileSync)(a),(0,N.writeFileSync)(a,In(o,t)),(0,N.unlinkSync)(o)})};var me=["list","create","edit","show"],fe=async(e,t)=>{var o;let r=(e==null?void 0:e.path)||oe(E()).path,n=e.actions||me.join(",");if(!t.length){let{name:a,selectedActions:c}=await bt.default.prompt([{type:"input",name:"name",message:"Resource Name",validate:i=>i?!0:"Resource Name is required"},{type:"checkbox",name:"selectedActions",message:"Select Actions",choices:me,default:(o=e==null?void 0:e.actions)==null?void 0:o.split(",")}]);t=[a],n=c.join(",")}t.forEach(a=>{let c=n?n.split(","):void 0,i=(0,xt.plural)(a).toLowerCase(),d=(0,ke.join)(process.cwd(),r,i);if((0,T.pathExistsSync)(d)){console.error(`\u274C Resource (${(0,ke.join)(r,i)}) already exist!`);return}let l=dt(a),u=wt(),w=`${__dirname}/../templates/resource`,R=bn();(0,T.copySync)(w,R);let g={resourceName:a,resource:l,actions:c||me,uiFramework:u};Rt(R,g),c&&me.forEach(j=>{c.includes(j)||(0,T.unlinkSync)(`${R}/${j}.tsx`)}),(0,T.mkdirSync)(r,{recursive:!0});let m=`${r}/${i}`,f={};(0,T.pathExistsSync)(m)&&(f={overwrite:!0}),(0,T.moveSync)(R,m,f),ue.default.cleanupSync();let h=s.resolve(".bin/jscodeshift"),{stderr:k,stdout:O}=It.default.sync(h,["./","--extensions=ts,tsx,js,jsx","--parser=tsx",`--transform=${__dirname}/../src/transformers/resource.ts`,"--ignore-pattern=**/.cache/**","--ignore-pattern=**/node_modules/**","--ignore-pattern=**/build/**","--ignore-pattern=**/.next/**",`--__actions=${g.actions}`,`--__pathAlias=${oe(E()).alias}`,`--__resourceFolderName=${i}`,`--__resource=${l}`,`--__resourceName=${a}`]);k&&console.log(k),console.log(`\u{1F389} Resource (${m}) generated successfully!`)})},bn=()=>(ue.default.track(),ue.default.mkdirSync("resource"));var Cn=e=>{let t=E(),{path:r}=oe(t);return e.command("create-resource").allowExcessArguments(!0).description('Create a new resource files (deprecated, please use "add resource" command)').option("-a, --actions [actions]","Only generate the specified actions. (ex: list,create,edit,show)","list,create,edit,show").option("-p, --path [path]","Path to generate the resource files",r).action(On)},On=async(e,t)=>{fe(e,t.args)},Ct=Cn;var Ot=p(s("dotenv"));Ot.config();var Tn={development:/dev/i,production:/prod/i,test:/test|tst/i,"continuous-integration":/ci/i,"user-acceptance-testing":/uat/i,"system-integration-testing":/sit/i},An=()=>{let e=process.env.NODE_ENV;if(!e)return"development";let t="custom";for(let[r,n]of Object.entries(Tn))if(n.test(e)){t=r;break}return t},A={NODE_ENV:An(),REFINE_NO_TELEMETRY:process.env.REFINE_NO_TELEMETRY||"false",UPDATE_NOTIFIER_IS_DISABLED:process.env.UPDATE_NOTIFIER_IS_DISABLED||"false",UPDATE_NOTIFIER_CACHE_TTL:process.env.UPDATE_NOTIFIER_CACHE_TTL||1e3*60*60*24,REFINE_PROXY_DOMAIN:process.env.REFINE_PROXY_DOMAIN||"https://refine.dev",REFINE_PROXY_TARGET:process.env.REFINE_PROXY_TARGET||"http://localhost:3000",REFINE_PROXY_PORT:process.env.REFINE_PROXY_PORT||"7313",REFINE_PROXY_REWRITE_URL:process.env.REFINE_REWRITE_URL||"http://localhost:7313"};var Tt=p(s("express")),ge=s("http-proxy-middleware"),_n=e=>e.command("proxy").description("Manage proxy settings").action(kn).option("-p, --port [port]","Port to serve the proxy server. You can also set this with the `REFINE_PROXY_PORT` environment variable.",A.REFINE_PROXY_PORT).option("-t, --target [target]","Target to proxy. You can also set this with the `REFINE_PROXY_TARGET` environment variable.",A.REFINE_PROXY_TARGET).option("-d, --domain [domain]","Domain to proxy. You can also set this with the `REFINE_PROXY_DOMAIN` environment variable.",A.REFINE_PROXY_DOMAIN).option("-r, --rewrite-url [rewrite URL]","Rewrite URL for redirects. You can also set this with the `REFINE_PROXY_REWRITE_URL` environment variable.",A.REFINE_PROXY_REWRITE_URL),kn=async({port:e,target:t,domain:r,rewriteUrl:n})=>{let o=(0,Tt.default)(),c=new URL(t).protocol==="http:"?i=>{var d;i.headers["set-cookie"]&&((d=i.headers["set-cookie"])==null||d.forEach((l,u)=>{i&&i.headers&&i.headers["set-cookie"]&&(i.headers["set-cookie"][u]=l.replace("Secure;",""))}))}:void 0;o.use("/.refine",(0,ge.createProxyMiddleware)({target:`${r}/.refine`,changeOrigin:!0,pathRewrite:{"^/.refine":""},logProvider:()=>({log:console.log,info:i=>{`${i}`.includes("Proxy rewrite rule created")||(`${i}`.includes("Proxy created")?console.log(`Proxying localhost:${e}/.refine to ${r}/.refine`):i&&console.log(i))},warn:console.warn,debug:console.debug,error:console.error})})),o.use("/.auth",(0,ge.createProxyMiddleware)({target:`${r}/.auth`,changeOrigin:!0,cookieDomainRewrite:{"refine.dev":""},headers:{"auth-base-url-rewrite":`${n}/.auth`},pathRewrite:{"^/.auth":""},logProvider:()=>({log:console.log,info:i=>{`${i}`.includes("Proxy rewrite rule created")||(`${i}`.includes("Proxy created")?console.log(`Proxying localhost:${e}/.auth to ${r}/.auth`):i&&console.log(i))},warn:console.warn,debug:console.debug,error:console.error}),onProxyRes:c})),o.use("*",(0,ge.createProxyMiddleware)({target:`${t}`,changeOrigin:!0,ws:!0,logProvider:()=>({log:console.log,info:i=>{`${i}`.includes("Proxy created")?console.log(`Proxying localhost:${e} to ${t}`):i&&console.log(i)},warn:console.warn,debug:console.debug,error:console.error})})),o.listen(Number(e))},At=_n;var $t=s("commander");var St=p(s("conf")),Nt=p(s("chalk"));var _t=e=>typeof btoa<"u"?btoa(e):Buffer.from(e).toString("base64");var Sn="refine-update-notifier",$=new St.default({projectName:Sn,defaults:{key:"",lastUpdated:0,packages:[]}}),J=async()=>{if(Ln())return;let e=await jn();if(e!==null){if(e){kt();return}Nn(),kt()}},Nn=async()=>{let e=$.get("packages");e!=null&&e.length&&(await pe({data:e}),console.log(`
`))},jn=async()=>{let e=await $n(),t=Dn();return e===null?null:!!(t||!e)},kt=async()=>{try{let e=await ne();return $.set("packages",e),$.set("lastUpdated",Date.now()),$.set("key",await jt()),e}catch{return $.set("packages",[]),$.set("lastUpdated",Date.now()),$.set("key",""),null}},Dn=()=>{let e=$.get("lastUpdated");if(!e)return!0;let r=Date.now()-e,n=Number(A.UPDATE_NOTIFIER_CACHE_TTL);return r>=n},$n=async()=>{let e=$.get("key"),t=await jt();return t===null?null:e===t},jt=async()=>{let e=await z();if(!e)return console.error(Nt.default.red("Something went wrong when trying to get installed `refine` packages.")),null;let t=e.map(n=>`${n.name}@${n.version}`);return _t(t.toString())},Ln=()=>A.UPDATE_NOTIFIER_IS_DISABLED.toLocaleLowerCase()==="true";var _={["react-scripts"]:{dev:["start"],start:["start"],build:["build"],getBin:()=>s.resolve(".bin/react-scripts")},["vite"]:{dev:["dev"],start:["preview"],build:["build"],getBin:()=>s.resolve(".bin/vite")},["nextjs"]:{dev:["dev"],start:["start"],build:["build"],getBin:()=>s.resolve(".bin/next")},["remix"]:{dev:["dev"],start:["build"],build:["build"],getBin:e=>{let t=e==="start"?"remix-serve":"remix";return s.resolve(`.bin/${t}`)}},["craco"]:{dev:["start"],start:["start"],build:["build"],getBin:()=>s.resolve(".bin/craco")},["parcel"]:{dev:["start"],start:["start"],build:["build"],getBin:()=>s.resolve(".bin/parcel")},["unknown"]:{dev:[],start:[],build:[],getBin:()=>"unknown"}};var Dt=p(s("execa")),L=async(e,t)=>{var n,o;if(e==="unknown"){let a=Object.values(x).filter(c=>c!=="unknown").join(", ");console.error(`We couldn't find executable for your project. Supported executables are ${a}.
Please use your own script directly. If you think this is an issue, please report it at: https://github.com/refinedev/refine/issues`);return}let r=(0,Dt.default)(e,t,{stdio:"pipe",windowsHide:!1,env:{FORCE_COLOR:"true",...process.env}});return(n=r.stdout)==null||n.pipe(process.stdout),(o=r.stderr)==null||o.pipe(process.stderr),await r};var Y=e=>{let t=E(),r=_[t][e];return t==="remix"&&e==="start"&&(t="remix-serve"),`It runs: \`${t} ${r.join(" ")}\`. Also accepts all the arguments \`${t}\` accepts.`},G=()=>`Platform to run command on. 
ex: ${Object.values(x).join(", ")}`;var Un=e=>e.command("start").description(Y("start")).allowUnknownOption(!0).addOption(new $t.Option("-p, --platform <platform>",G()).choices(Object.values(x).filter(t=>t!=="unknown"))).argument("[args...]").action(Fn),Fn=async(e,{platform:t})=>{let r=E(t),n=_[r].getBin("start"),a=[..._[r].start,...e];await J(),L(n,a)},Se=Un;var Ve=s("commander");var ir=p(rr());var nr=p(s("execa"));var Pe=s("prettier"),Le=async e=>{try{let t=await(0,Pe.resolveConfig)(process.cwd());return(0,Pe.format)(e,{...t??{},parser:"typescript"})}catch{return e}};var or=async()=>{let e=s.resolve(".bin/jscodeshift"),{stderr:t}=nr.default.sync(e,["./","--extensions=ts,tsx,js,jsx","--parser=tsx",`--transform=${__dirname}/../src/transformers/add-devtools-component.ts`,"--ignore-pattern=**/.cache/**","--ignore-pattern=**/node_modules/**","--ignore-pattern=**/build/**","--ignore-pattern=**/.next/**"]);t&&console.log(t)};var ar=()=>{let t=q().scripts||{};return{dev:((t==null?void 0:t.dev)||"").match(/refine dev(\s|$|;){1}/)!==null}};var sr=p(s("boxen")),cr=p(s("cardinal")),Fe=p(s("chalk")),lr=s("commander"),dr=p(s("dedent")),Ee=p(s("semver")),ia=["start","init"],sa="start",pr="4.42.0",ca=e=>e.command("devtools").description("Start or install refine's devtools server; it starts on port 5001.").addArgument(new lr.Argument("[command]","devtools related commands").choices(ia).default(sa)).addHelpText("after",`
Commands:
    start     Start refine's devtools server
    init      Install refine's devtools client and adds it to your project
`).action(la),la=async e=>{switch(e){case"start":qe();return;case"init":da();return}},da=async()=>{var o;let e=await Ue();if(await F(le,"Checking if devtools is installed...")){console.log("\u{1F389} refine devtools is already installed");return}if(e&&await mr({pkg:e}))return;console.log("\u{1F331} Installing refine devtools...");let r=["@refinedev/devtools@latest"];if((!e||Ee.default.lt(e.version,pr))&&(r.push("@refinedev/core@latest"),console.log("\u{1F331} refine core package is being updated for devtools...")),await st(r),console.log(""),console.log(""),console.log("\u{1F331} Adding devtools component to your project...."),await or(),console.log("\u2705 refine devtools package and components added to your project"),r.includes("@refinedev/core@latest")){let a=await Ue();console.log(`\u2705 refine core package updated from ${(e==null?void 0:e.version)??"unknown"} to ${(a==null?void 0:a.version)??"unknown"}`),console.log(`   Changelog: ${Fe.default.underline.blueBright(`https://c.refine.dev/core#${(e==null?void 0:e.version.replaceAll(".",""))??""}`)}`)}console.log("");let{dev:n}=ar();if(n){console.log(`\u{1F64C} You're good to go. "npm run dev" will automatically starts the devtools server.`),console.log('\u{1F449} You can also start the devtools server manually by running "refine devtools start"');return}if(!n){let a=(o=q().scripts)==null?void 0:o.dev;console.log('\u{1F6A8} Your have modified the "dev" script in your package.json. Because of that, "npm run dev" will not start the devtools server automatically.'),console.log('\u{1F449} You can append "refine devtools" to "dev" script'),console.log('\u{1F449} You can start the devtools server manually by running "refine devtools"'),console.log(""),console.log((0,sr.default)(cr.default.highlight((0,dr.default)(`
                {
                    "scripts": {
                        "dev": "${a} & refine devtools",
                        "refine": "refine"
                    }
                }  
        `)),{padding:1,title:"package.json",dimBorder:!0,borderColor:"blueBright",borderStyle:"round"}))}},qe=async()=>{let e=await Ue();if(e){if(await mr({pkg:e}))return;if(Ee.default.lt(e.version,pr)){console.log(`\u{1F6A8} You're using an old version of refine(${e.version}). refine version should be @4.42.0 or higher to use devtools.`);let t=await b();console.log(`\u{1F449} You can update @refinedev/core package by running "${t.name} run refine update"`);return}}(0,ir.server)()},Ue=async()=>{let e=await te(),t=e==null?void 0:e.find(r=>r.name==="@refinedev/core"||r.name==="@pankod/refine-core");if(t)return t},mr=async({pkg:e})=>e.name==="@pankod/refine-core"||Ee.default.lt(e.version,"4.0.0")?(console.log(`\u{1F6A8} You're using an old version of refine(${e.version}). refine version should be @4.42.0 or higher to use devtools.`),console.log("You can follow migration guide to update refine."),console.log(Fe.default.blue("https://refine.dev/docs/migration-guide/3x-to-4x/")),!0):!1,ur=ca;var pa=e=>e.command("dev").description(Y("dev")).allowUnknownOption(!0).addOption(new Ve.Option("-p, --platform <platform>",G()).choices(Object.values(x).filter(t=>t!=="unknown"))).addOption(new Ve.Option("-d, --devtools","Start refine's devtools server")).argument("[args...]").action(ma),ma=async(e,{platform:t,devtools:r})=>{let n=E(t),o=_[n].getBin("dev"),c=[..._[n].dev,...e];await J();let i=await le();(r??i)&&qe(),L(o,c)},Me=pa;var fr=s("commander");var ua=e=>e.command("build").description(Y("build")).allowUnknownOption(!0).addOption(new fr.Option("-p, --platform <platform>",G()).choices(Object.values(x).filter(t=>t!=="unknown"))).argument("[args...]").action(fa),fa=async(e,{platform:t})=>{let r=E(t),n=_[r].getBin("build"),a=[..._[r].build,...e];await J();try{await L(n,a)}catch{process.exit(1)}},Be=ua;var We=p(s("chalk"));var ga=e=>e.command("run").description("Runs a defined package script. If no `command` is provided, it will list the available scripts").allowUnknownOption(!0).argument("[command] [args...]").action(ha),ha=async e=>{let[t,...r]=e,n=se();if(!t){console.log(`Available via ${We.default.blue("`refine run`")}:
`);for(let[c,i]of Object.entries(n))console.log(`  ${c}`),console.log(`    ${We.default.dim(i)}`),console.log();return}if(!Object.keys(n).includes(t)){let c=`${process.cwd()}/node_modules/.bin/${t}`;L(c,r);return}let a=await b();L(a.name,["run",t,...r])},He=ga;var Ge=p(s("path")),W=p(s("chalk")),ae=p(s("inquirer")),Ur=p(s("inquirer-autocomplete-prompt")),U=s("fs-extra");var Je=p(s("path"));var Er=p(s("path"));var ze={};gn(ze,{PackageManagerTypes:()=>yt,ProjectTypes:()=>x,UIFrameworks:()=>_e,appendAfterImports:()=>yr,getFileContent:()=>Re,getImports:()=>K,getNameChangeInImport:()=>hr});var va=/import(?:(?:(?:[ \n\t]+([^ *\n\t\{\},]+)[ \n\t]*(?:,|[ \n\t]+))?([ \n\t]*\{(?:[ \n\t]*[^ \n\t"'\{\}]+[ \n\t]*,?)+\})?[ \n\t]*)|[ \n\t]*\*[ \n\t]*as[ \n\t]+([^ \n\t\{\}]+)[ \n\t]+)from[ \n\t]*(?:['"])([^'"\n]+)(?:['"])(?:;?)/g,ya=/((?:\w|\s|_)*)( as )((?:\w|\s|_)*)( |,)?/g,K=e=>{let t=e.matchAll(va),r=[];for(let n of t){let[o,a,c,i,d]=n;r.push({statement:o,importPath:d,...a&&{defaultImport:a},...c&&{namedImports:c},...i&&{namespaceImport:i}})}return r==null?void 0:r.filter(Boolean)},hr=e=>{let t=e.matchAll(ya),r=[];for(let n of t){let[o,a,c,i,d]=n;r.push({statement:o,fromName:a.trim(),toName:i.trim(),afterCharacter:d})}return r},wa=(e,t)=>{var a;let r=e.substring(0,e.indexOf(t.statement)),n=K(r).pop();return n?r.substring(r.indexOf(n==null?void 0:n.statement)+((a=n==null?void 0:n.statement)==null?void 0:a.length)):r},Pa=(e,t)=>!!(t?wa(e,t):"").trim(),gr=["react","@refinedev/core","@refinedev/"],vr=e=>{var g;let t=e,r=K(e),n=r.filter(m=>!m.statement.includes("import type ")),o=r.filter(m=>m.statement.includes("import type")),a=[],c=[];n.forEach(m=>{Pa(e,m)?a.push(m):c.push(m)});let i=t.indexOf((g=c==null?void 0:c[0])==null?void 0:g.statement);c.forEach(m=>{t=t.replace(m.statement,"")}),o.forEach(m=>{t=t.replace(m.statement,"")});let d=c.reduce((m,f)=>{let{importPath:h}=f;return m[h]?m[h].push(f):m[h]=[f],m},{}),w=[...Object.entries(d).map(([m,f])=>{let h=f.find(S=>S.defaultImport),k=f.find(S=>S.namespaceImport),O=f.filter(S=>S.namedImports).map(S=>(S.namedImports??"").replace(/{|}/g,"").trim().split(",").map(Oe=>Oe.trim()).filter(Boolean).join(", ")).join(", "),j="";return k&&(j+=k.statement+`
`),(h||O)&&(h&&O?j+=`import ${h.defaultImport}, { ${O} } from "${f[0].importPath}";
`:h?j+=`import ${h.defaultImport} from "${f[0].importPath}";
`:j+=`import { ${O} } from "${f[0].importPath}";
`),[m,j]})].sort(([m],[f])=>{let h=gr.findIndex(O=>m.includes(O)),k=gr.findIndex(O=>f.includes(O));return h===k?m.localeCompare(f):h===-1?1:k===-1?-1:h-k}).map(([,m])=>m).join(""),R=o.map(m=>m.statement).join(`
`);return t=t.substring(0,i)+w+R+t.substring(i),t};var yr=(e,t)=>{let r=K(e),n=r[r.length-1],o=n?e.indexOf(n.statement):e.length-1;return e.slice(0,o+(n==null?void 0:n.statement.length))+`
`+t+`
`+e.slice(o+(n==null?void 0:n.statement.length))};var wr=s("fs-extra"),Pr=s("path");function Re(e){if(this!=null&&this.absolutePackageDir)try{return(0,wr.readFileSync)((0,Pr.join)(this.absolutePackageDir,e)).toString()}catch{return}}var Rr=s("module"),Ea=Rr.prototype.require,xr=(e,t)=>{Rr.prototype.require=function(...r){return r[0]==="@refinedev/cli"?{...ze,getFileContent:n=>Re.call({absolutePackageDir:t?e:Er.default.join(process.cwd(),e)},n)}:Ea.apply(this,r)}};var Ye=async(e,t)=>{try{return xr(e,t),s(Je.default.join(t?e:Je.default.join(process.cwd(),e),"refine.config.js"))}catch{return}};var _r=p(s("dedent"));var C={SUCCESS:"SUCCESS",UNKNOWN_ERROR:"UNKNOWN_ERROR",SOURCE_PATH_NOT_FOUND:"SOURCE_PATH_NOT_FOUND",TARGET_PATH_NOT_FOUND:"TARGET_PATH_NOT_FOUND",SOURCE_PATH_NOT_A_FILE:"SOURCE_PATH_NOT_A_FILE",TARGET_ALREADY_EXISTS:"TARGET_ALREADY_EXISTS"};var I=p(s("chalk"));var Ir=p(s("chalk")),br=p(s("cardinal")),Cr=p(s("boxen")),Ra=e=>{let t=/^(?:\/\/\s?title:\s?)(.*?)\n/g,[r,n]=t.exec(e)??[];if(n){let o=n.trim(),a=e.replace(r||"","");return{title:o,code:a}}return{code:e}},Or=e=>{let{title:t,code:r}=Ra(e),n="";try{n=br.default.highlight(r,{jsx:!0})}catch{n=r}return(0,Cr.default)(n,{padding:1,margin:0,borderStyle:"round",borderColor:"gray",titleAlignment:"left",title:t?Ir.default.bold(t):void 0})};var Tr=s("marked"),Ar=p(s("marked-terminal")),xe=e=>(0,Tr.marked)(e,{renderer:new Ar.default({code:Or})});var kr=({label:e,files:t,message:r="**`Warning:`** You should use the component where you want to use it."})=>{let n=t.filter(([,l])=>Object.values(C).filter(u=>u!==C.SUCCESS).includes(l)),o="success";switch(n.length){case 0:o="success";break;case t.length:o="error";break;default:o="warning";break}let a=l=>{let u=l==null?void 0:l.replace(process.cwd(),"");return u!=null&&u.startsWith("/")?u.slice(1):u!=null&&u.startsWith("./")?u.slice(2):u},c=()=>{switch(o){case"success":console.log(I.default.blueBright(`Successfully swizzled ${I.default.bold(e)}`));return;case"warning":console.log(I.default.yellowBright(`Swizzle completed with errors for ${I.default.bold(e)}`));return;case"error":console.log(I.default.redBright(`Swizzle failed for ${I.default.bold(e)}`));return;default:return}},i=()=>{let l=[];l.push(I.default.dim(`File${t.length>1?"s":""} created:`)),l.push(t.map(([u,w])=>w===C.SUCCESS?I.default.cyanBright.dim(` - ${a(u)}`):w===C.TARGET_ALREADY_EXISTS?I.default.cyanBright.dim(` - ${I.default.yellowBright.bold("[FILE_ALREADY_EXISTS] ")}${a(u)}`):w===C.SOURCE_PATH_NOT_A_FILE?I.default.cyanBright.dim(` - ${I.default.yellowBright.bold("[SOURCE NOT FOUND] ")}${a(u)}`):I.default.cyanBright.dim(` - ${I.default.yellowBright.bold(`[${w}]`)}${a(u)}`)).join(`
`)),console.log(l.join(`
`))},d=()=>{r&&o!=="error"&&console.log(xe((0,_r.default)(`
`+r)))};console.log(""),c(),i(),console.log(""),d()};var Sr=e=>{let t=/(\/\/|\/\*)(\s?)swizzle-remove-start([\s\S]*?)(\/\/|\/\*)(\s?)swizzle-remove-end(\s*)(\*\/)?/g;return e.replace(t,"")};var Fr=p(s("boxen"));var Nr=()=>{let e;try{e=E()}catch{e=void 0}return Et(e)};var jr=p(s("inquirer")),Dr=p(s("chalk"));var $r=async e=>{await xa(e)?await ce(e):await Ia(e)},xa=async e=>{let t=`This component requires following packages to be installed:
`.concat(e.map(n=>` - ${n}`).join(`
`)).concat(`
Do you want to install them?`),{installRequiredPackages:r}=await jr.default.prompt([{type:"confirm",name:"installRequiredPackages",default:!0,message:t}]);return r},Ia=async e=>{let t=await b(),r=V[t.name].install.join(" "),n=e.join(" "),o=`${t.name} ${r} ${n}`;console.log(`
You can install them manually by running this command:`),console.log(Dr.default.bold.blueBright(o))};var ba=e=>e.command("swizzle").description(`Export a component or a function from ${W.default.bold("refine")} packages to customize it in your project`).action(Ca),Lr=e=>(t,r="")=>e.filter(o=>{var a;return o.label.toLowerCase().includes(r.toLowerCase())||((a=o.group)==null?void 0:a.toLowerCase().includes(r.toLowerCase()))}).flatMap((o,a,c)=>{var l;return[...(o==null?void 0:o.group)&&((l=c[a-1])==null?void 0:l.group)!==o.group&&o.group?[new ae.default.Separator(`${W.default.bold(o.group)}`)]:[],{name:` ${o.label}`,value:o!=null&&o.value?o.value:o}]}),Ca=async e=>{var u,w,R;ae.default.registerPrompt("autocomplete",Ur.default);let t=await te(),r=[];if(await Promise.all(t.map(async g=>{let m=await it(g.path),f=r.findIndex(h=>h.name===g.name)===-1;m&&f&&r.push(g)})),r.length===0){console.log("No refine packages found with swizzle configuration.");return}console.log(`${(0,Fr.default)(`Found ${W.default.blueBright(r.length)} installed ${W.default.blueBright.bold("refine")} packages with swizzle configuration.`,{padding:1,textAlignment:"center",dimBorder:!0,borderColor:"blueBright",borderStyle:"round"})}
`);let n=await Promise.all(r.map(async g=>{let m=await Ye(g.path,!0)??await Ye(g.path,!1)??{swizzle:{items:[]}};return{...g,config:m}})),{selectedPackage:o}=await ae.default.prompt([{type:"autocomplete",pageSize:10,name:"selectedPackage",message:"Which package do you want to swizzle?",emptyText:"No packages found.",source:Lr(n.sort((g,m)=>{var f,h;return(((f=g.config)==null?void 0:f.group)??"").localeCompare(((h=m.config)==null?void 0:h.group)??"")}).map(g=>{var m,f;return{label:((m=g.config)==null?void 0:m.name)??g.name,value:g,group:(f=g.config)==null?void 0:f.group}}))}]),{swizzle:{items:a,transform:c}}=o.config,i;if(a.length===0){console.log(`No swizzle items found for ${W.default.bold(((u=o.config)==null?void 0:u.name)??o.name)}`);return}else a.length===1?i=a[0]:a.length>1&&(i=(await ae.default.prompt([{type:"list",pageSize:10,name:"selectedComponent",message:"Which component do you want to swizzle?",emptyText:"No components found.",choices:Lr(a.sort((m,f)=>m.group.localeCompare(f.group)))({},"")}])).selectedComponent);if(!i){console.log(`No swizzle items selected for ${W.default.bold(((w=o.config)==null?void 0:w.name)??o.name)}`);return}let d=Nr(),l=await Promise.all(i.files.map(async g=>{var m;try{let f=g.src?Ge.default.join(o.path,g.src):void 0,h=g.dest?Ge.default.join(process.cwd(),d,g.dest):void 0;if(!f)return console.log("No src path found for file",g),["",C.SOURCE_PATH_NOT_FOUND];if(!h)return console.log("No destination path found for file",g),["",C.TARGET_PATH_NOT_FOUND];if(!await(0,U.pathExists)(f))return[h,C.SOURCE_PATH_NOT_A_FILE];let O=await(0,U.readFile)(f,"utf-8");if(await(0,U.pathExists)(h))return[h,C.TARGET_ALREADY_EXISTS];await(0,U.ensureFile)(h);let S=Sr(O),Ce=((m=g.transform)==null?void 0:m.call(g,S))??S,Oe=(c==null?void 0:c(Ce,f,h))??Ce,cn=vr(Oe),ln=await Le(cn);return await(0,U.writeFile)(h,ln),[h,C.SUCCESS]}catch{return["",C.UNKNOWN_ERROR]}}));l.length>0&&(kr({files:l,label:i.label,message:i.message}),(R=i==null?void 0:i.requiredPackages)!=null&&R.length&&await $r(i.requiredPackages))},qr=ba;var Br=s("commander");var Q=p(s("inquirer")),Xe=p(s("semver-diff")),Ie=p(s("chalk"));var Vr=e=>{let t=e.filter((n,o)=>e.indexOf(n)!==o),r=new Set(t);return Array.from(r)};var Mr=async e=>{let t=Ta(e);if(!t){console.log("All `refine` packages are up to date. \u{1F389}");return}let r=Aa(t),n=await Q.default.prompt([{type:"checkbox",name:"packages",message:"Choose packages to update",pageSize:r.pageSize,choices:r.choices,validate:Oa}]);return n.packages.length>0?n.packages:null},Oa=e=>{let r=e.map(o=>ct(o)).map(o=>o.name),n=Vr(r);return n.length>0?`You can't update the same package more than once. Please choice one.
 Duplicates: ${n.join(", ")}`:!0},Ta=e=>{if(e.length===0)return null;let t={patch:[],minor:[],major:[]};return e.forEach(r=>{let n=r.current,o=(0,Xe.default)(n,r.wanted),a=(0,Xe.default)(n,r.latest);if(o===a&&a){t[a].push({name:r.name,from:n,to:r.latest});return}o&&t[o].push({name:r.name,from:n,to:r.wanted}),a&&t[a].push({name:r.name,from:n,to:r.latest})}),t},Aa=e=>{let t=0,r=0;[e.patch,e.minor,e.major].forEach(l=>{l.forEach(u=>{u.name.length>t&&(t=u.name.length),u.from.length>r&&(r=u.from.length)})}),t+=2;let n=[],o="Package".padEnd(t),a="From".padEnd(r),i=`
   ${o} ${a}${"To".padStart(r)}`;n.push(new Q.default.Separator(i)),e.patch.length>0&&(n.push(new Q.default.Separator(Ie.default.reset.bold.blue(`
Patch Updates`))),e.patch.forEach(l=>{n.push({name:`${l.name.padEnd(t)} ${l.from.padStart(r)} -> ${l.to}`,value:`${l.name}@${l.to}`})})),e.minor.length>0&&(n.push(new Q.default.Separator(Ie.default.reset.bold.blue(`
Minor Updates`))),e.minor.forEach(l=>{n.push({name:`${l.name.padEnd(t)} ${l.from.padStart(r)} -> ${l.to}`,value:`${l.name}@${l.to}`})})),e.major.length>0&&(n.push(new Q.default.Separator(Ie.default.reset.bold.blue(`
Major Updates`))),e.major.forEach(l=>{n.push({name:`${l.name.padEnd(t)} ${l.from.padStart(r)} -> ${l.to}`,value:`${l.name}@${l.to}`})}));let d=n.length+6;return{choices:n,pageSize:d}};var _a=e=>e.command("update").description("Interactively select and update all `refine` packages to selected version. To skip the interactive mode, use the `--all` option.").addOption(new Br.Option("-t, --tag [tag]","Select version to update to.").choices(["next","latest"]).default("wanted","Version ranges in the `package.json` will be installed")).option("-a, --all","Update all `refine` packages to the selected `tag`. If `tag` is not provided, version ranges in the `package.json` will be installed. This option skips the interactive mode.",!1).option("-d, --dry-run","Get outdated packages installation command without automatic updating. If `tag` is not provided, version ranges in the `package.json` will be used.",!1).action(ka),ka=async e=>{let{tag:t,dryRun:r,all:n}=e,o=await F(ne,"Checking for updates...");if(!(o!=null&&o.length)){console.log("All `refine` packages are up to date \u{1F389}");return}let a=n?Sa(t,o):await Mr(o);if(a){if(r){Na(a);return}ja(a)}},Sa=(e,t)=>e==="wanted"&&t.every(o=>o.current===o.wanted)?(console.log("All `refine` packages are up to date with the wanted version \u{1F389}"),null):t.map(n=>{let o=e==="wanted"?n.wanted:e;return`${n.name}@${o}`}),Na=async e=>{let t=await b(),r=V[t.name].install;console.log(`${t.name} ${r.join(" ")} ${e.join(" ")}`)},ja=e=>{console.log("Updating `refine` packages..."),console.log(e),ce(e)},Wr=_a;var Hr=p(s("envinfo")),zr=p(s("ora")),Da=e=>e.command("whoami").description("View the details of the development environment").action($a),$a=async()=>{let e=(0,zr.default)("Loading environment details...").start(),t=await Hr.default.run({System:["OS","CPU"],Binaries:["Node","Yarn","npm"],Browsers:["Chrome","Firefox","Safari"]},{showNotFound:!0,markdown:!0}),n=(await z()||[]).map(o=>` - ${o.name}: ${o.version}`).join(`
`);e.stop(),console.log(t),console.log("## Refine Packages:"),console.log(n)},Jr=Da;var Ze=s("commander");var Z=s("fs-extra"),Ke=s("path");var H=`${__dirname}/../templates/provider`,Qe=["auth","live","data","access-control","notification","i18n","audit-log"],Yr=(e,t)=>{e.forEach(r=>{let{fileName:n,templatePath:o}=La(r),a=t??Ua(),c=(0,Ke.join)(a,n),i=(0,Ke.join)(process.cwd(),a,n);if((0,Z.pathExistsSync)(i)){console.error(`\u274C Provider (${c}) already exist!`);return}(0,Z.mkdirSync)(a,{recursive:!0}),(0,Z.copySync)(o,i),console.log(`\u{1F389} Provider (${c}) created successfully!`)})},be={auth:{fileName:"auth-provider.tsx",templatePath:`${H}/demo-auth-provider.tsx`},live:{fileName:"live-provider.tsx",templatePath:`${H}/demo-live-provider.tsx`},data:{fileName:"data-provider.tsx",templatePath:`${H}/demo-data-provider.tsx`},"access-control":{fileName:"access-control-provider.tsx",templatePath:`${H}/demo-access-control-provider.tsx`},notification:{fileName:"notification-provider.tsx",templatePath:`${H}/demo-notification-provider.tsx`},i18n:{fileName:"i18n-provider.tsx",templatePath:`${H}/demo-i18n-provider.tsx`},"audit-log":{fileName:"audit-log-provider.tsx",templatePath:`${H}/demo-audit-log-provider.tsx`}},La=e=>{if(!(be!=null&&be[e]))throw new Error(`Invalid provider: ${e}`);return be[e]},Ua=()=>{let e=E(),{path:t}=Pt(e);return t};var Fa=e=>e.command("add").allowExcessArguments(!1).addArgument(new Ze.Argument("[provider]","Create a new provider").choices([...Qe,"resource"]).argOptional()).addArgument(new Ze.Argument("[resource...]","Create a new resource files").argOptional()).option("-p, --path [path]","Path to generate files").option("-a, --actions [actions]","Only generate the specified resource actions. (ex: list,create,edit,show)","list,create,edit,show").action(qa),qa=async(e,t,r,n)=>{let o=n==null?void 0:n.args;if(!o.length){await Ma();return}let{providers:a,resources:c}=Va(o);a.length&&Yr(a,r==null?void 0:r.path),o.includes("resource")&&fe({actions:r==null?void 0:r.actions,path:r==null?void 0:r.path},c)},Va=e=>{let t=e.findIndex(o=>o==="resource");if(t===-1)return{providers:Gr(e),resources:[]};let r=Gr(e.slice(0,t)),n=e.slice(t+1);return{providers:r,resources:n}},Ma=async()=>{let{name:e}=await b();console.log("\u274C Please provide a feature name"),console.log(`For more information please use: "${e} run refine add help"`)},Gr=e=>e.filter(t=>Qe.includes(t)?!0:(console.log(`\u274C "${t}" is not a valid provider`),!1)),Xr=Fa;var Kr=p(s("envinfo")),Qr=p(s("os")),Ba=()=>{let e=Qr.default.type();return{Darwin:"macOS",Linux:"Linux",Windows_NT:"Windows"}[e]},Zr=async()=>{let[e,t]=await Kr.default.helpers.getOSInfo();return{name:Ba(),version:t}};var en=p(s("node-fetch")),Wa=async()=>{let e=await Zr();return{nodeEnv:A.NODE_ENV,nodeVersion:process.version,os:e.name,osVersion:e.version,command:process.argv[2],packages:await z()||[],projectFramework:E(),projectId:lt()}},tn=async()=>{if(A.REFINE_NO_TELEMETRY!=="true")try{let e=await Wa();await(0,en.default)("https://telemetry.refine.dev/cli",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}})}catch{}};var rn=p(s("gray-matter")),nn=p(s("boxen"));var Ha="https://raw.githubusercontent.com/refinedev/refine/master/packages/cli/ANNOUNCEMENTS.md",et="---announcement",za=e=>e.split(et).slice(1).map(r=>`${et}${r}`),Ja=e=>{let t=e.replace(et,"---"),r=(0,rn.default)(t),n=(r.content.length===0?t.replace(/---/g,""):r.content.replace(/---/g,"")).trim();return{...r.data,content:n}},Ya=async()=>{try{let e=await fetch(Ha).then(r=>r.text()).catch(()=>"");return za(e).map(r=>Ja(r))}catch{return[]}},on=async()=>{let t=(await Ya()).filter(n=>!n.hidden);if(t.length===0)return;let r=t.map(n=>{let o=t.length>1?"\u2014 ":"",a=xe(n.content);return`${o}${a}`}).join("").trim();console.log((0,nn.default)(r,{padding:1,margin:0,borderStyle:"round",borderColor:"blueBright",titleAlignment:"left"}))};var Ga="1.0.0",Xa=()=>{let e=new an.Command;e.version(`@refinedev/cli@${Ga}`,"-v, --version","Output the current version.").description(sn.default.textSync("refine",{font:"Isometric1",horizontalLayout:"full",verticalLayout:"full",whitespaceBreak:!0})).usage("<command> [options]").helpOption("-h, --help","Output usage information."),qr(e),Ct(e),Wr(e),Me(e),Be(e),Se(e),He(e),vt(e),Jr(e),At(e),ur(e),Xr(e),e.hook("preAction",on),e.hook("postAction",t=>{let r=t.args[0];["run"].includes(r)||tn()}),e.parse(process.argv),process.argv.slice(2).length||e.outputHelp()};Xa();})();
//# sourceMappingURL=cli.js.map